# Scripts Directory

This directory contains utility scripts for the Vantage CLI project.

## generate_command_docs.py

**Purpose**: Automatically generates comprehensive Markdown documentation from extracted CLI help files.

**What it does**:

- Reads command help files and index.json created by `extract_command_help.py`
- Parses help content to extract usage, descriptions, arguments, and options
- Generates structured Markdown documentation with collapsible sections
- Creates properly formatted command reference documentation
- Handles nested command structures (2+ levels deep)
- Replaces internal python module calls with clean `vantage` command names

**Output**:
- Complete Markdown documentation file ready for documentation sites
- Structured with headers, collapsible details, and code blocks
- Auto-generated metadata (CLI version, generation timestamp)

**Usage**:
```bash
# Generate to default location (docs/commands.md)
python scripts/generate_command_docs.py

# Generate from custom help directory to custom output
python scripts/generate_command_docs.py /path/to/help/files /path/to/output.md

# Complete workflow example
python scripts/extract_command_help.py docs/command-help
python scripts/generate_command_docs.py docs/command-help docs/commands.md
```

**Dependencies**: Requires help files generated by `extract_command_help.py`

**Generated Features**:
- Authentication commands section
- Nested command groups with collapsible details
- Usage examples with proper `vantage` command syntax  
- Automatic argument and option extraction
- Properly formatted Markdown for Jekyll/GitHub Pages

## update_docs_version.py

**Purpose**: Automatically updates documentation files with the current version from `pyproject.toml`.

**Files Updated**:
- `docs/_data/project.yml` - Updates version and date fields
- `docs/_config.yml` - Adds/updates version field
- `docs/index.md` - Adds version to front matter

**Usage**:
```bash
# Using justfile (recommended)
just update-docs-version

# Direct execution
python scripts/update_docs_version.py

# Using shell wrapper
./scripts/update_docs_version.sh
```

**Dependencies**: 
- Python 3.7+ with `tomllib` (Python 3.11+) or `tomli` package

## update_docs_version.sh

**Purpose**: Shell wrapper for `update_docs_version.py` that handles dependency installation.

**Usage**:
```bash
./scripts/update_docs_version.sh
```

## Integration

### Local Development
Use `just update-docs-version` before building documentation locally.

### CI/CD (GitHub Pages)
The version update is automatically integrated into the GitHub Pages workflow in `.github/workflows/pages.yml`.

### Manual Execution
Both Python script and shell wrapper can be run independently for custom build processes.

## update_docs.sh

**Purpose**: Complete automation script that extracts CLI help and generates comprehensive documentation in one execution.

**What it does**:
- Runs `extract_command_help.py` to discover and extract help from all commands  
- Runs `generate_command_docs.py` to convert help files to Markdown documentation
- Provides comprehensive logging and error handling
- Displays summary statistics and next steps

**Usage**:
```bash
# Complete documentation update (recommended)
./scripts/update_docs.sh

# This single command:
# 1. Extracts help from all CLI commands → docs/command-help/
# 2. Generates documentation → docs/commands.md  
# 3. Provides summary and file statistics
```

**Output Summary**:
- Help files extracted and documentation generated
- File counts and sizes reported
- Success/failure status for each step
- Instructions for next steps

## Complete Documentation Workflow

The scripts provide a complete automation pipeline for maintaining CLI documentation:

### Workflow Steps
1. **Extract Help**: `extract_command_help.py` discovers all commands and extracts help
2. **Generate Docs**: `generate_command_docs.py` converts help to structured Markdown
3. **Automation**: `update_docs.sh` runs both steps with comprehensive reporting

### Integration Options

**Local Development**:
```bash
# Full automation (recommended)
./scripts/update_docs.sh

# Individual steps for debugging
python3 scripts/extract_command_help.py docs/command-help
python3 scripts/generate_command_docs.py docs/command-help docs/commands.md
```

**CI/CD Integration**:
```bash
# In build scripts or GitHub Actions
./scripts/update_docs.sh

# Or integrate individual steps with custom paths
python3 scripts/extract_command_help.py $HELP_DIR
python3 scripts/generate_command_docs.py $HELP_DIR $DOCS_FILE
```

**File Structure**:
```
docs/
├── command-help/           # Generated by extract_command_help.py
│   ├── main.txt           # Main CLI help
│   ├── cloud_add.txt      # Individual command help
│   ├── cluster_federation_create.txt
│   ├── license_server_list.txt
│   ├── index.json         # Command structure metadata
│   └── ...
└── commands.md            # Generated by generate_command_docs.py
```

## When to Use

- **Before releasing**: Ensure documentation reflects the current version
- **Before building docs**: Keep documentation in sync with package version
- **In CI/CD**: Automatically update version during deployment

The scripts are designed to be idempotent - running them multiple times with the same version will not cause issues.
